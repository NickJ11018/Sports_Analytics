/*-- Create a new table for fantasy football stats
CREATE TEMPORARY TABLE fantasy_football_stats (
    Rk INT,
    Player VARCHAR(255),
    PPR DECIMAL(5, 2),
    Team VARCHAR(3),
    Opp VARCHAR(3),
    Result VARCHAR(10),
    Pos VARCHAR(2),
    ID VARCHAR(10)
);

-- Insert data from the CSV into the table
INSERT INTO fantasy_football_stats (Rk, Player, PPR, Team, Opp, Result, Pos, ID)
VALUES
    (1, 'C.J. Stroud', 41.80, 'HOU', 'TAM', 'W 39-37', 'QB', 'StroCJ00'),
    (2, 'Tank Dell', 29.60, 'HOU', 'TAM', 'W 39-37', 'WR', 'DellNa00'),
    (3, 'Dak Prescott', 28.36, 'DAL', 'PHI', 'L 23-28', 'QB', 'PresDa01')
    -- Add the rest of the rows here

-- Query the data
SELECT *
FROM fantasy_football_stats
*/

-- Create a common table expression (CTE) with the CSV data
WITH fantasy_football_data AS (
    SELECT * FROM (
        VALUES
            (1, 'C.J. Stroud', 41.80, 'HOU', 'TAM', 'W 39-37', 'QB', 'StroCJ00'),
(2, 'Tank Dell', 29.60, 'HOU', 'TAM', 'W 39-37', 'WR', 'DellNa00'),
(3, 'Dak Prescott', 28.36, 'DAL', 'PHI', 'L 23-28', 'QB', 'PresDa01'),
(4, 'CeeDee Lamb', 28.10, 'DAL', 'PHI', 'L 23-28', 'WR', 'LambCe00'),
(5, 'Rachaad White', 27.90, 'TAM', 'HOU', 'L 37-39', 'RB', 'WhitRa01'),
(6, 'Noah Brown', 27.30, 'HOU', 'TAM', 'W 39-37', 'WR', 'BrowNo00'),
(7, 'Dalton Schultz', 27.00, 'HOU', 'TAM', 'W 39-37', 'TE', 'SchuDa00'),
(8, 'Jalen Hurts', 25.88, 'PHI', 'DAL', 'W 28-23', 'QB', 'HurtJa00'),
(9, 'Joshua Dobbs', 24.92, 'MIN', 'ATL', 'W 31-28', 'QB', 'DobbJo00'),
(10, 'Amari Cooper', 24.90, 'CLE', 'ARI', 'W 27-0', 'WR', 'CoopAm00'),
(11, 'Josh Allen', 24.72, 'BUF', 'CIN', 'L 18-24', 'QB', 'AlleJo02'),
(12, 'Cole Kmet', 23.50, 'CHI', 'NOR', 'L 17-24', 'TE', 'KmetCo00'),
(13, 'Cade Otton', 23.00, 'TAM', 'HOU', 'L 37-39', 'TE', 'OttoCa00'),
(14, 'Rhamondre Stevenson', 22.90, 'NWE', 'WAS', 'L 17-20', 'RB', 'StevRh00'),
(15, 'Stefon Diggs', 22.60, 'BUF', 'CIN', 'L 18-24', 'WR', 'DiggSt00'),
(16, 'Joe Burrow', 22.32, 'CIN', 'BUF', 'W 24-18', 'QB', 'BurrJo01'),
(17, 'Jake Ferguson', 22.10, 'DAL', 'PHI', 'L 23-28', 'TE', 'FergJa00'),
(18, 'Diontae Johnson', 22.00, 'PIT', 'TEN', 'W 20-16', 'WR', 'JohnDi01'),
(19, 'Josh Jacobs', 21.80, 'LVR', 'NYG', 'W 30-6', 'RB', 'JacoJo01'),
(20, 'Austin Ekeler', 21.00, 'LAC', 'NYJ', 'W 27-6', 'RB', 'EkelAu00'),
(21, 'Jonnu Smith', 21.00, 'ATL', 'MIN', 'L 28-31', 'TE', 'SmitJo01'),
(22, 'Taysom Hill', 20.62, 'NOR', 'CHI', 'W 24-17', 'QB', 'HillTa00'),
(23, 'Keaton Mitchell', 20.40, 'BAL', 'SEA', 'W 37-3', 'RB', 'MitcKe01'),
(24, 'A.J. Brown', 19.60, 'PHI', 'DAL', 'W 28-23', 'WR', 'BrowAJ00'),
(25, 'Derrick Henry', 19.20, 'TEN', 'PIT', 'L 16-20', 'RB', 'HenrDe00'),
(26, 'Tee Higgins', 19.00, 'CIN', 'BUF', 'W 24-18', 'WR', 'HiggTe00'),
(27, 'Baker Mayfield', 19.00, 'TAM', 'HOU', 'L 37-39', 'QB', 'MayfBa00'),
(28, 'Deshaun Watson', 18.96, 'CLE', 'ARI', 'W 27-0', 'QB', 'WatsDe00'),
(29, 'Younghoe Koo', 18.00, 'ATL', 'MIN', 'L 28-31', 'K', 'KooxYo00'),
(30, 'Aaron Jones', 17.90, 'GNB', 'LAR', 'W 20-3', 'RB', 'JoneAa00'),
(31, 'Jonathan Taylor', 17.90, 'IND', 'CAR', 'W 27-13', 'RB', 'TaylJo02'),
(32, 'Joe Mixon', 17.80, 'CIN', 'BUF', 'W 24-18', 'RB', 'MixoJo00'),
(33, 'Sam Howell', 17.70, 'WAS', 'NWE', 'W 20-17', 'QB', 'HoweSa00'),
(34, 'Alexander Mattison', 17.30, 'MIN', 'ATL', 'W 31-28', 'RB', 'MattAl01'),
(35, 'Gus Edwards', 17.20, 'BAL', 'SEA', 'W 37-3', 'RB', 'EdwaGu00'),
(36, 'Mark Andrews', 17.00, 'BAL', 'SEA', 'W 37-3', 'TE', 'AndrMa00'),
(37, 'Jahan Dotson', 16.90, 'WAS', 'NWE', 'W 20-17', 'WR', 'DotsJa00'),
(38, 'Derek Carr', 16.74, 'NOR', 'CHI', 'W 24-17', 'QB', 'CarrDe02'),
(39, 'Chris Olave', 16.60, 'NOR', 'CHI', 'W 24-17', 'WR', 'OlavCh00'),
(40, 'Dalton Kincaid', 16.10, 'BUF', 'CIN', 'L 18-24', 'TE', 'KincDa00'),
(41, 'Tyson Bagent', 15.80, 'CHI', 'NOR', 'L 17-24', 'QB', 'BageTy00'),
(42, 'Patrick Mahomes', 15.80, 'KAN', 'MIA', 'W 21-14', 'QB', 'MahoPa00'),
(43, 'Keenan Allen', 15.70, 'LAC', 'NYJ', 'W 27-6', 'WR', 'AlleKe00'),
(44, 'Najee Harris', 15.60, 'PIT', 'TEN', 'W 20-16', 'RB', 'HarrNa00'),
(45, 'Chase McLaughlin', 15.00, 'TAM', 'HOU', 'L 37-39', 'K', 'McLaCh00'),
(46, 'Taylor Heinicke', 14.72, 'ATL', 'MIN', 'L 28-31', 'QB', 'HeinTa00'),
(47, 'Odell Beckham Jr.', 14.60, 'BAL', 'SEA', 'W 37-3', 'WR', 'BeckOd00'),
(48, 'Raheem Mostert', 14.50, 'MIA', 'KAN', 'L 14-21', 'RB', 'MostRa00'),
(49, 'Nico Collins', 14.40, 'HOU', 'TAM', 'W 39-37', 'WR', 'CollNi00'),
(50, 'Michael Pittman Jr.', 14.40, 'IND', 'CAR', 'W 27-13', 'WR', 'PittMi01'),
(51, 'Saquon Barkley', 14.30, 'NYG', 'LVR', 'L 6-30', 'RB', 'BarkSa00'),
(52, 'Jaylen Warren', 14.30, 'PIT', 'TEN', 'W 20-16', 'RB', 'WarrJa01'),
(53, 'Luke Musgrave', 14.10, 'GNB', 'LAR', 'W 20-3', 'TE', 'MusgLu00'),
(54, 'DeVonta Smith', 14.10, 'PHI', 'DAL', 'W 28-23', 'WR', 'SmitDe07'),
(55, 'Hunter Henry', 13.90, 'NWE', 'WAS', 'L 17-20', 'TE', 'HenrHu00'),
(56, 'T.J. Hockenson', 13.90, 'MIN', 'ATL', 'W 31-28', 'TE', 'HockTJ00'),
(57, 'Juwan Johnson', 13.90, 'NOR', 'CHI', 'W 24-17', 'TE', 'JohnJu02'),
(58, 'Jalen Tolbert', 13.90, 'DAL', 'PHI', 'L 23-28', 'WR', 'TolbJa00'),
(59, 'Jordan Love', 13.82, 'GNB', 'LAR', 'W 20-3', 'QB', 'LoveJo03'),
(60, 'Jakobi Meyers', 13.50, 'LVR', 'NYG', 'W 30-6', 'WR', 'MeyeJa01'),
(61, 'WanDale Robinson', 13.50, 'NYG', 'LVR', 'L 6-30', 'WR', 'RobiWa01'),
(62, 'Darnell Mooney', 13.20, 'CHI', 'NOR', 'L 17-24', 'WR', 'MoonDa00'),
(63, 'Justin Tucker', 13.00, 'BAL', 'SEA', 'W 37-3', 'K', 'TuckJu00'),
(64, 'Garrett Wilson', 13.00, 'NYJ', 'LAC', 'L 6-27', 'WR', 'WilsGa00'),
(65, 'Mike Evans', 12.70, 'TAM', 'HOU', 'L 37-39', 'WR', 'EvanMi00'),
(66, 'Jerome Ford', 12.70, 'CLE', 'ARI', 'W 27-0', 'RB', 'FordJe00'),
(67, 'Tyler Conklin', 12.60, 'NYJ', 'LAC', 'L 6-27', 'TE', 'ConkTy00'),
(68, 'Antonio Gibson', 12.60, 'WAS', 'NWE', 'W 20-17', 'RB', 'GibsAn00'),
(69, 'David Njoku', 12.60, 'CLE', 'ARI', 'W 27-0', 'TE', 'NjokDa00'),
(70, 'Tyreek Hill', 12.50, 'MIA', 'KAN', 'L 14-21', 'WR', 'HillTy00'),
(71, 'Tua Tagovailoa', 12.42, 'MIA', 'KAN', 'L 14-21', 'QB', 'TagoTu00'),
(72, 'Terry McLaurin', 12.30, 'WAS', 'NWE', 'W 20-17', 'WR', 'McLaTe00'),
(73, 'Jaxon Smith-Njigba', 12.30, 'SEA', 'BAL', 'L 3-37', 'WR', 'SmitJa06'),
(74, 'Daniel Carlson', 12.00, 'LVR', 'NYG', 'W 30-6', 'K', 'CarlDa00'),
(75, 'Drew Sample', 12.00, 'CIN', 'BUF', 'W 24-18', 'TE', 'SampDr00'),
(76, 'Brian Robinson Jr.', 11.70, 'WAS', 'NWE', 'W 20-17', 'RB', 'RobiBr01'),
(77, 'Irv Smith Jr.', 11.60, 'CIN', 'BUF', 'W 24-18', 'TE', 'SmitIr01'),
(78, 'Lamar Jackson', 11.48, 'BAL', 'SEA', 'W 37-3', 'QB', 'JackLa00'),
(79, 'Mac Jones', 11.10, 'NWE', 'WAS', 'L 17-20', 'QB', 'JoneMa05'),
(80, 'JuJu Smith-Schuster', 11.10, 'NWE', 'WAS', 'L 17-20', 'WR', 'SmitJu00'),
(81, 'Tyler Allgeier', 11.00, 'ATL', 'MIN', 'L 28-31', 'RB', 'AllgTy00'),
(82, 'Cameron Dicker', 11.00, 'LAC', 'NYJ', 'W 27-6', 'K', 'DickCa00'),
(83, 'Matt Gay', 11.00, 'IND', 'CAR', 'W 27-13', 'K', 'GayxMa00'),
(84, 'Greg Joseph', 11.00, 'MIN', 'ATL', 'W 31-28', 'K', 'JoseGr00'),
(85, 'Alvin Kamara', 11.00, 'NOR', 'CHI', 'W 24-17', 'RB', 'KamaAl00'),
(86, 'Kyle Philips', 10.80, 'TEN', 'PIT', 'L 16-20', 'WR', 'PhilKy01'),
(87, 'Chuba Hubbard', 10.70, 'CAR', 'IND', 'L 13-27', 'RB', 'HubbCh01'),
(88, 'Demario Douglas', 10.50, 'NWE', 'WAS', 'L 17-20', 'WR', 'DougDe00'),
(89, 'DeAndre Hopkins', 10.50, 'TEN', 'PIT', 'L 16-20', 'WR', 'HopkDe00'),
(90, 'Jerick McKinnon', 10.40, 'KAN', 'MIA', 'W 21-14', 'RB', 'McKiJe00'),
(91, 'Kenny Pickett', 10.30, 'PIT', 'TEN', 'W 20-16', 'QB', 'PickKe00'),
(92, 'Jordan Addison', 10.20, 'MIN', 'ATL', 'W 31-28', 'WR', 'AddiJo00'),
(93, 'Cedrick Wilson Jr.', 10.10, 'MIA', 'KAN', 'L 14-21', 'WR', 'WilsCe01'),
(94, 'Nick Folk', 10.00, 'TEN', 'PIT', 'L 16-20', 'K', 'FolkNi20'),
(95, 'Breece Hall', 10.00, 'NYJ', 'LAC', 'L 6-27', 'RB', 'HallBr03'),
(96, 'Darius Slayton', 9.90, 'NYG', 'LVR', 'L 6-30', 'WR', 'SlayDa01'),
(97, 'Kareem Hunt', 9.80, 'CLE', 'ARI', 'W 27-0', 'RB', 'HuntKa00'),
(98, 'Rashee Rice', 9.70, 'KAN', 'MIA', 'W 21-14', 'WR', 'RiceRa01'),
(99, 'Khalil Shakir', 9.70, 'BUF', 'CIN', 'L 18-24', 'WR', 'ShakKh00'),
(100, 'Kyle Pitts', 9.60, 'ATL', 'MIN', 'L 28-31', 'TE', 'PittKy00'),
(101, 'Gardner Minshew II', 9.58, 'IND', 'CAR', 'W 27-13', 'QB', 'MinsGa00'),
(102, 'Brandon Powell', 9.50, 'MIN', 'ATL', 'W 31-28', 'WR', 'PoweBr00'),
(103, 'DAndre Swift', 9.40, 'PHI', 'DAL', 'W 28-23', 'RB', 'SwifDA00'),
(104, 'Kenneth Gainwell', 9.30, 'PHI', 'DAL', 'W 28-23', 'RB', 'GainKe00'),
(105, 'Tony Pollard', 9.30, 'DAL', 'PHI', 'L 23-28', 'RB', 'PollTo00'),
(106, 'Miles Sanders', 9.10, 'CAR', 'IND', 'L 13-27', 'RB', 'SandMi01'),
(107, 'Bryce Young', 9.02, 'CAR', 'IND', 'L 13-27', 'QB', 'YounBr01'),
(108, 'KhaDarel Hodge', 9.00, 'ATL', 'MIN', 'L 28-31', 'WR', 'HodgKh00'),
(109, 'Dustin Hopkins', 9.00, 'CLE', 'ARI', 'W 27-0', 'K', 'HopkDu00'),
(110, 'DJ Chark', 8.90, 'CAR', 'IND', 'L 13-27', 'WR', 'CharDJ00'),
(111, 'Tommy DeVito', 8.70, 'NYG', 'LVR', 'L 6-30', 'QB', 'DeViTo00'),
(112, 'Will Levis', 8.68, 'TEN', 'PIT', 'L 16-20', 'QB', 'LeviWi00'),
(113, 'Tyler Boyd', 8.60, 'CIN', 'BUF', 'W 24-18', 'WR', 'BoydTy00'),
(114, 'Tanner Hudson', 8.50, 'CIN', 'BUF', 'W 24-18', 'TE', 'HudsTa00'),
(115, 'Byron Pringle', 8.50, 'WAS', 'NWE', 'W 20-17', 'WR', 'PrinBy00'),
(116, 'Michael Carter', 8.40, 'NYJ', 'LAC', 'L 6-27', 'RB', 'CartMi03'),
(117, 'Jaylen Waddle', 8.40, 'MIA', 'KAN', 'L 14-21', 'WR', 'WaddJa00'),
(118, 'Aidan OConnell', 8.36, 'LVR', 'NYG', 'W 30-6', 'QB', 'OConAi00'),
(119, 'DOnta Foreman', 8.30, 'CHI', 'NOR', 'L 17-24', 'RB', 'ForeDO00'),
(120, 'Isaiah Likely', 8.20, 'BAL', 'SEA', 'W 37-3', 'TE', 'LikeIs00'),
(121, 'JaMarr Chase', 8.10, 'CIN', 'BUF', 'W 24-18', 'WR', 'ChasJa00'),
(122, 'Trey Palmer', 8.10, 'TAM', 'HOU', 'L 37-39', 'WR', 'PalmTr00'),
(123, 'Chris Boswell', 8.00, 'PIT', 'TEN', 'W 20-16', 'K', 'BoswCh00'),
(124, 'Anders Carlson', 8.00, 'GNB', 'LAR', 'W 20-3', 'K', 'CarlAn00'),
(125, 'Dallas Goedert', 8.00, 'PHI', 'DAL', 'W 28-23', 'TE', 'GoedDa00'),
(126, 'Blake Grupe', 8.00, 'NOR', 'CHI', 'W 24-17', 'K', 'GrupBl00'),
(127, 'Joey Slye', 8.00, 'WAS', 'NWE', 'W 20-17', 'K', 'SlyeJo00'),
(128, 'James Cook', 7.90, 'BUF', 'CIN', 'L 18-24', 'RB', 'CookJa01'),
(129, 'Adam Thielen', 7.90, 'CAR', 'IND', 'L 13-27', 'WR', 'ThieAd00'),
(130, 'Tre Tucker', 7.60, 'LVR', 'NYG', 'W 30-6', 'WR', 'TuckTr00'),
(131, 'KaVontae Turpin', 7.50, 'DAL', 'PHI', 'L 23-28', 'WR', 'TurpKa00'),
(132, 'Davante Adams', 7.40, 'LVR', 'NYG', 'W 30-6', 'WR', 'AdamDa01'),
(133, 'Hayden Hurst', 7.40, 'CAR', 'IND', 'L 13-27', 'TE', 'HursHa00'),
(134, 'Daniel Bellinger', 7.30, 'NYG', 'LVR', 'L 6-30', 'TE', 'BellDa00'),
(135, 'Zach Wilson', 7.22, 'NYJ', 'LAC', 'L 6-27', 'QB', 'WilsZa00'),
(136, 'Justin Herbert', 7.14, 'LAC', 'NYJ', 'W 27-6', 'QB', 'HerbJu00'),
(137, 'Logan Thomas', 7.10, 'WAS', 'NWE', 'W 20-17', 'TE', 'ThomLo00'),
(138, 'Brandon Aubrey', 7.00, 'DAL', 'PHI', 'L 23-28', 'K', 'AubrBr00'),
(139, 'Derius Davis', 7.00, 'LAC', 'NYJ', 'W 27-6', 'WR', 'DaviDe02'),
(140, 'Eddy Pineiro', 7.00, 'CAR', 'IND', 'L 13-27', 'K', 'PineEd00'),
(141, 'Jayden Reed', 7.00, 'GNB', 'LAR', 'W 20-3', 'WR', 'ReedJa03'),
(142, 'Dontayvion Wicks', 6.90, 'GNB', 'LAR', 'W 20-3', 'WR', 'WickDo00'),
(143, 'Cam Akers', 6.80, 'MIN', 'ATL', 'W 31-28', 'RB', 'AkerCa00'),
(144, 'Cooper Kupp', 6.80, 'LAR', 'GNB', 'L 3-20', 'WR', 'KuppCo00'),
(145, 'Stephen Sullivan', 6.80, 'CAR', 'IND', 'L 13-27', 'TE', 'SullSt00'),
(146, 'Jeff Wilson', 6.80, 'MIA', 'KAN', 'L 14-21', 'RB', 'WilsJe01'),
(147, 'Romeo Doubs', 6.60, 'GNB', 'LAR', 'W 20-3', 'WR', 'DoubRo00'),
(148, 'Mack Hollins', 6.60, 'ATL', 'MIN', 'L 28-31', 'WR', 'HollMa00'),
(149, 'Isiah Pacheco', 6.60, 'KAN', 'MIA', 'W 21-14', 'RB', 'PachIs00'),
(150, 'Marquise Brown', 6.40, 'ARI', 'CLE', 'L 0-27', 'WR', 'BrowMa04'),
(151, 'Noah Gray', 6.40, 'KAN', 'MIA', 'W 21-14', 'TE', 'GrayNo00'),
(152, 'Tyler Huntley', 6.32, 'BAL', 'SEA', 'W 37-3', 'QB', 'HuntTy01'),
(153, 'Jamison Crowder', 6.30, 'WAS', 'NWE', 'W 20-17', 'WR', 'CrowJa00'),
(154, 'Ezekiel Elliott', 6.20, 'NWE', 'WAS', 'L 17-20', 'RB', 'ElliEz00'),
(155, 'Tyler Lockett', 6.20, 'SEA', 'BAL', 'L 3-37', 'WR', 'LockTy00'),
(156, 'Puka Nacua', 6.20, 'LAR', 'GNB', 'L 3-20', 'WR', 'NacuPu00'),
(157, 'Tyjae Spears', 6.20, 'TEN', 'PIT', 'L 16-20', 'RB', 'SpeaTy00'),
(158, 'Kaimi Fairbairn', 6.00, 'HOU', 'TAM', 'W 39-37', 'K', 'FairKa01'),
(159, 'Evan McPherson', 6.00, 'CIN', 'BUF', 'W 24-18', 'K', 'McPhEv00'),
(160, 'D.K. Metcalf', 6.00, 'SEA', 'BAL', 'L 3-37', 'WR', 'MetcDK00'),
(161, 'Greg Zuerlein', 6.00, 'NYJ', 'LAC', 'L 6-27', 'K', 'ZuerGr00'),
(162, 'Bijan Robinson', 5.90, 'ATL', 'MIN', 'L 28-31', 'RB', 'RobiBi01'),
(163, 'Rashod Bateman', 5.80, 'BAL', 'SEA', 'W 37-3', 'WR', 'BateRa00'),
(164, 'Chigoziem Okonkwo', 5.80, 'TEN', 'PIT', 'L 16-20', 'TE', 'OkonCh00'),
(165, 'Darrell Henderson', 5.50, 'LAR', 'GNB', 'L 3-20', 'RB', 'HendDa00'),
(166, 'D.J. Moore', 5.40, 'CHI', 'NOR', 'L 17-24', 'WR', 'MoorD.00'),
(167, 'Tutu Atwell', 5.30, 'LAR', 'GNB', 'L 3-20', 'WR', 'AtweTu00'),
(168, 'Dyami Brown', 5.30, 'WAS', 'NWE', 'W 20-17', 'WR', 'BrowDy00'),
(169, 'AJ Dillon', 5.30, 'GNB', 'LAR', 'W 20-3', 'RB', 'DillAJ00'),
(170, 'Skyy Moore', 5.30, 'KAN', 'MIA', 'W 21-14', 'WR', 'MoorSk01'),
(171, 'Xavier Gipson', 5.20, 'NYJ', 'LAC', 'L 6-27', 'WR', 'GipsXa00'),
(172, 'Trey McBride', 5.20, 'ARI', 'CLE', 'L 0-27', 'TE', 'McBrTr01'),
(173, 'Hunter Renfrow', 5.20, 'LVR', 'NYG', 'W 30-6', 'WR', 'RenfHu00'),
(174, 'Rashid Shaheed', 5.20, 'NOR', 'CHI', 'W 24-17', 'WR', 'ShahRa00'),
(175, 'Lucas Havrisik', 5.00, 'LAR', 'GNB', 'L 3-20', 'K', 'HavrLu00'),
(176, 'Chad Ryland', 5.00, 'NWE', 'WAS', 'L 17-20', 'K', 'RylaCh00'),
(177, 'Cairo Santos', 5.00, 'CHI', 'NOR', 'L 17-24', 'K', 'SantCa01'),
(178, 'Treylon Burks', 4.80, 'TEN', 'PIT', 'L 16-20', 'WR', 'BurkTr00'),
(179, 'Durham Smythe', 4.70, 'MIA', 'KAN', 'L 14-21', 'TE', 'SmytDu00'),
(180, 'Christian Watson', 4.70, 'GNB', 'LAR', 'W 20-3', 'WR', 'WatsCh00'),
(181, 'Devin Singletary', 4.60, 'HOU', 'TAM', 'W 39-37', 'RB', 'SingDe00'),
(182, 'Ameer Abdullah', 4.50, 'LVR', 'NYG', 'W 30-6', 'RB', 'AbduAm00'),
(183, 'Travis Kelce', 4.40, 'KAN', 'MIA', 'W 21-14', 'TE', 'KelcTr00'),
(184, 'Emanuel Wilson', 4.30, 'GNB', 'LAR', 'W 20-3', 'RB', 'WilsEm00'),
(185, 'Jaren Hall', 4.22, 'MIN', 'ATL', 'W 31-28', 'QB', 'HallJa00'),
(186, 'Marquez Valdes-Scantling', 4.20, 'KAN', 'MIA', 'W 21-14', 'WR', 'ValdMa00'),
(187, 'Darrynton Evans', 4.10, 'CHI', 'NOR', 'L 17-24', 'RB', 'EvanDa02'),
(188, 'Kendre Miller', 4.10, 'NOR', 'CHI', 'W 24-17', 'RB', 'MillKe01'),
(189, 'Tyler Bass', 4.00, 'BUF', 'CIN', 'L 18-24', 'K', 'BassTy00'),
(190, 'Jake Elliott', 4.00, 'PHI', 'DAL', 'W 28-23', 'K', 'ElliJa03'),
(191, 'Mecole Hardman', 4.00, 'KAN', 'MIA', 'W 21-14', 'WR', 'HardMe00'),
(192, 'Justice Hill', 4.00, 'BAL', 'SEA', 'W 37-3', 'RB', 'HillJu00'),
(193, 'Michael Gallup', 3.90, 'DAL', 'PHI', 'L 23-28', 'WR', 'GallMi00'),
(194, 'Jalin Hyatt', 3.90, 'NYG', 'LVR', 'L 6-30', 'WR', 'HyatJa00'),
(195, 'Chris Moore', 3.90, 'TEN', 'PIT', 'L 16-20', 'WR', 'MoorCh00'),
(196, 'Gerald Everett', 3.80, 'LAC', 'NYJ', 'W 27-6', 'TE', 'EverGe00'),
(197, 'Allen Lazard', 3.80, 'NYJ', 'LAC', 'L 6-27', 'WR', 'LazaAl00'),
(198, 'K.J. Osborn', 3.70, 'MIN', 'ATL', 'W 31-28', 'WR', 'OsboKJ00'),
(199, 'Chris Godwin', 3.60, 'TAM', 'HOU', 'L 37-39', 'WR', 'GodwCh00'),
(200, 'Connor Heyward', 3.60, 'PIT', 'TEN', 'W 20-16', 'TE', 'HeywCo00'),
(201, 'Quentin Johnston', 3.60, 'LAC', 'NYJ', 'W 27-6', 'WR', 'JohnQu02'),
(202, 'Parris Campbell', 3.50, 'NYG', 'LVR', 'L 6-30', 'WR', 'CampPa00'),
(203, 'Justin Watson', 3.50, 'KAN', 'MIA', 'W 21-14', 'WR', 'WatsJu01'),
(204, 'Elijah Moore', 3.40, 'CLE', 'ARI', 'W 27-0', 'WR', 'MoorEl00'),
(205, 'Foster Moreau', 3.30, 'NOR', 'CHI', 'W 24-17', 'TE', 'MoreFo00'),
(206, 'Nick Westbrook-Ikhine', 3.30, 'TEN', 'PIT', 'L 16-20', 'WR', 'WestNi00'),
(207, 'Salvon Ahmed', 3.20, 'MIA', 'KAN', 'L 14-21', 'RB', 'AhmeSa01'),
(208, 'Royce Freeman', 3.20, 'LAR', 'GNB', 'L 3-20', 'RB', 'FreeRo00'),
(209, 'Trishton Jackson', 3.20, 'MIN', 'ATL', 'W 31-28', 'WR', 'JackTr02'),
(210, 'Joshua Kelley', 3.20, 'LAC', 'NYJ', 'W 27-6', 'RB', 'KellJo01'),
(211, 'Tommy Tremble', 3.20, 'CAR', 'IND', 'L 13-27', 'TE', 'TremTo00'),
(212, 'Jamaal Williams', 3.20, 'NOR', 'CHI', 'W 24-17', 'RB', 'WillJa06'),
(213, 'Michael Mayer', 3.10, 'LVR', 'NYG', 'W 30-6', 'TE', 'MayeMi00'),
(214, 'Brett Rypien', 3.10, 'LAR', 'GNB', 'L 3-20', 'QB', 'RypiBr00'),
(215, 'C.J. Uzomah', 3.10, 'NYJ', 'LAC', 'L 6-27', 'TE', 'UzomC.00'),
(216, 'Harrison Butker', 3.00, 'KAN', 'MIA', 'W 21-14', 'K', 'ButkHa00'),
(217, 'Devin Duvernay', 3.00, 'BAL', 'SEA', 'W 37-3', 'WR', 'DuveDe00'),
(218, 'Jason Myers', 3.00, 'SEA', 'BAL', 'L 3-37', 'K', 'MyerJa00'),
(219, 'Dare Ogunbowale', 3.00, 'HOU', 'TAM', 'W 39-37', 'RB', 'OgunDa00'),
(220, 'Andrew Ogletree', 2.90, 'IND', 'CAR', 'W 27-13', 'TE', 'OgleAn00'),
(221, 'Johnny Mundt', 2.80, 'MIN', 'ATL', 'W 31-28', 'TE', 'MundJo00'),
(222, 'Kadarius Toney', 2.80, 'KAN', 'MIA', 'W 21-14', 'WR', 'ToneKa00'),
(223, 'Tony Jones', 2.70, 'ARI', 'CLE', 'L 0-27', 'RB', 'JoneTo04'),
(224, 'Kenneth Walker III', 2.70, 'SEA', 'BAL', 'L 3-37', 'RB', 'WalkKe00'),
(225, 'Geno Smith', 2.68, 'SEA', 'BAL', 'L 3-37', 'QB', 'SmitGe00'),
(226, 'Zack Moss', 2.60, 'IND', 'CAR', 'W 27-13', 'RB', 'MossZa00'),
(227, 'Andrew Beck', 2.50, 'HOU', 'TAM', 'W 39-37', 'FB', 'BeckAn01'),
(228, 'DeAndre Carter', 2.50, 'LVR', 'NYG', 'W 30-6', 'WR', 'CartDe02'),
(229, 'Roschon Johnson', 2.50, 'CHI', 'NOR', 'L 17-24', 'RB', 'JohnRo07'),
(230, 'Demarcus Robinson', 2.50, 'LAR', 'GNB', 'L 3-20', 'WR', 'RobiDe01'),
(231, 'Van Jefferson', 2.40, 'ATL', 'MIN', 'L 28-31', 'WR', 'JeffVa00'),
(232, 'John Metchie', 2.40, 'HOU', 'TAM', 'W 39-37', 'WR', 'MetcJo00'),
(233, 'Zach Charbonnet', 2.30, 'SEA', 'BAL', 'L 3-37', 'RB', 'CharZa00'),
(234, 'Jordan Akins', 2.10, 'CLE', 'ARI', 'W 27-0', 'TE', 'AkinJo00'),
(235, 'Matt Breida', 2.10, 'NYG', 'LVR', 'L 6-30', 'RB', 'BreiMa00'),
(236, 'Zay Flowers', 2.10, 'BAL', 'SEA', 'W 37-3', 'WR', 'FlowZa00'),
(237, 'Josh Oliver', 2.10, 'MIN', 'ATL', 'W 31-28', 'TE', 'OlivJo00'),
(238, 'Jalen Reagor', 2.10, 'NWE', 'WAS', 'L 17-20', 'WR', 'ReagJa00'),
(239, 'Robert Tonyan', 2.10, 'CHI', 'NOR', 'L 17-24', 'TE', 'TonyRo00'),
(240, 'Josh Downs', 2.00, 'IND', 'CAR', 'W 27-13', 'WR', 'DownJo00'),
(241, 'Austin Hooper', 2.00, 'LVR', 'NYG', 'W 30-6', 'TE', 'HoopAu00'),
(242, 'Latavius Murray', 2.00, 'BUF', 'CIN', 'L 18-24', 'RB', 'MurrLa00'),
(243, 'Allen Robinson', 2.00, 'PIT', 'TEN', 'W 20-16', 'WR', 'RobiAl02'),
(244, 'Jason Sanders', 2.00, 'MIA', 'KAN', 'L 14-21', 'K', 'SandJa00'),
(245, 'Andrei Iosivas', 1.90, 'CIN', 'BUF', 'W 24-18', 'WR', 'IosiAn00'),
(246, 'Daniel Jones', 1.90, 'NYG', 'LVR', 'L 6-30', 'QB', 'JoneDa05'),
(247, 'Trent Sherfield', 1.90, 'BUF', 'CIN', 'L 18-24', 'WR', 'SherTr00'),
(248, 'Dalvin Cook', 1.80, 'NYJ', 'LAC', 'L 6-27', 'RB', 'CookDa01'),
(249, 'Rondale Moore', 1.80, 'ARI', 'CLE', 'L 0-27', 'WR', 'MoorRo02'),
(250, 'KeShawn Vaughn', 1.80, 'TAM', 'HOU', 'L 37-39', 'RB', 'VaugKe00'),
(251, 'Olamide Zaccheaus', 1.80, 'PHI', 'DAL', 'W 28-23', 'WR', 'ZaccOl01'),
(252, 'Nick Bawden', 1.70, 'NYJ', 'LAC', 'L 6-27', 'FB', 'BawdNi00'),
(253, 'Brandin Cooks', 1.70, 'DAL', 'PHI', 'L 23-28', 'WR', 'CookBr00'),
(254, 'Josiah Deguara', 1.70, 'GNB', 'LAR', 'W 20-3', 'TE', 'DeguJo00'),
(255, 'Jeremy Ruckert', 1.70, 'NYJ', 'LAC', 'L 6-27', 'TE', 'RuckJe00'),
(256, 'Malik Taylor', 1.70, 'NYJ', 'LAC', 'L 6-27', 'WR', 'TaylMa01'),
(257, 'Tyquan Thornton', 1.70, 'NWE', 'WAS', 'L 17-20', 'WR', 'ThorTy00'),
(258, 'Darnell Washington', 1.70, 'PIT', 'TEN', 'W 20-16', 'TE', 'WashDa03'),
(259, 'Miles Boykin', 1.60, 'PIT', 'TEN', 'W 20-16', 'WR', 'BoykMi00'),
(260, 'Colby Parkinson', 1.60, 'SEA', 'BAL', 'L 3-37', 'TE', 'ParkCo02'),
(261, 'Austin Trammell', 1.60, 'LAR', 'GNB', 'L 3-20', 'WR', 'TramAu00'),
(262, 'Raheem Blackshear', 1.50, 'CAR', 'IND', 'L 13-27', 'RB', 'BlacRa00'),
(263, 'Jonathan Mingo', 1.50, 'CAR', 'IND', 'L 13-27', 'WR', 'MingJo00'),
(264, 'Cordarrelle Patterson', 1.30, 'ATL', 'MIN', 'L 28-31', 'RB', 'PattCo00'),
(265, 'Cedric Tillman', 1.30, 'CLE', 'ARI', 'W 27-0', 'WR', 'TillCe01'),
(266, 'Trayveon Williams', 1.30, 'CIN', 'BUF', 'W 24-18', 'RB', 'WillTr06'),
(267, 'Nelson Agholor', 1.20, 'BAL', 'SEA', 'W 37-3', 'WR', 'AghoNe00'),
(268, 'Greg Dortch', 1.20, 'ARI', 'CLE', 'L 0-27', 'WR', 'DortGr01'),
(269, 'Xavier Hutchinson', 1.20, 'HOU', 'TAM', 'W 39-37', 'WR', 'HutcXa00'),
(270, 'Isaiah McKenzie', 1.20, 'IND', 'CAR', 'W 27-13', 'WR', 'McKeIs00'),
(271, 'Pierre Strong', 1.20, 'CLE', 'ARI', 'W 27-0', 'RB', 'StroPi00'),
(272, 'Alec Ingold', 1.10, 'MIA', 'KAN', 'L 14-21', 'FB', 'IngoAl01'),
(273, 'Calvin Austin', 1.00, 'PIT', 'TEN', 'W 20-16', 'WR', 'AustCa00'),
(274, 'Rico Dowdle', 0.80, 'DAL', 'PHI', 'L 23-28', 'RB', 'DowdRi01'),
(275, 'Keaontay Ingram', 0.80, 'ARI', 'CLE', 'L 0-27', 'RB', 'IngrKe01'),
(276, 'Rashaad Penny', 0.80, 'PHI', 'DAL', 'W 28-23', 'RB', 'PennRa00'),
(277, 'Mike Boone', 0.30, 'HOU', 'TAM', 'W 39-37', 'RB', 'BoonMi00'),
(278, 'Deon Jackson', 0.20, 'NYG', 'LVR', 'L 6-30', 'RB', 'JackDe02'),
(279, 'LaMical Perine', 0.10, 'KAN', 'MIA', 'W 21-14', 'RB', 'PeriLa00'),
(280, 'Lucas Patrick', 0.00, 'CHI', 'NOR', 'L 17-24', 'OL', 'PatrLu00'),
(281, 'Clayton Tune', '-0.88', 'ARI', 'CLE', 'L 0-27', 'QB', 'TuneCl00')

    ) AS fantasy_data(Rk, Player, PPR, Team, Opp, Result, Pos, ID)
)

---- Query the data from the CTE
--SELECT *
--FROM fantasy_football_data


--ALTER table Week9_2023 rename column "Pos." to pos;

Select Team, round(sum(cast(PPR as float)),2) as team_PPR
From(
	Select *
	FROM(
		SELECT Team
			, case when pos = 'FB' then 'RB' else Pos end as Pos
			, Player
			, cast(PPR as float) as PPR
			, (Select count(*) 
				from fantasy_football_data f2
				where f2.Team = f1.Team
				and f2.Pos = f1.Pos
				and cast(f2.PPR as float) >= cast(f1.PPR as float)
	    	  ) as rnk 
			, case when pos = 'QB' then 1
						when pos = 'RB' then 2
						when pos = 'WR' then 3
						when pos = 'TE' then 4
						when pos = 'K' then 5
						end as posrnk
		FROM fantasy_football_data f1
	) x 
	Where Pos in ('QB', 'RB', 'WR', 'TE', 'K')
	and (rnk = 1 
	     or (rnk = 2 and Pos in('RB', 'WR')))

--order by Team, posrnk, rnk
) y
Group by team
order by team_PPR desc




--and PPR > 0